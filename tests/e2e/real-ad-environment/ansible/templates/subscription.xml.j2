<!-- Windows Event Forwarding Subscription Configuration -->
<!-- Generated by Ansible for {{ inventory_hostname }} -->
<Subscription xmlns="http://schemas.microsoft.com/2006/03/windows/events/subscription">
  <SubscriptionId>{{ subscription_id }}</SubscriptionId>
  <SubscriptionType>SourceInitiated</SubscriptionType>
  <Description>Forward security events to WEF Server ({{ wef_server_fqdn }})</Description>
  <Enabled>true</Enabled>
  <Uri>http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>
  <ConfigurationMode>Custom</ConfigurationMode>
  <Delivery Mode="Push">
    <Batching>
      <MaxItems>{{ batch_max_items }}</MaxItems>
      <MaxLatencyTime>{{ batch_max_latency_ms }}</MaxLatencyTime>
    </Batching>
    <PushSettings>
      <Heartbeat Interval="{{ heartbeat_interval_ms }}"/>
    </PushSettings>
  </Delivery>
  <Query>
    <![CDATA[
      <QueryList>
        <Query Id="0" Path="Security">
          <Select Path="Security">*[System[({{ event_id_query }})]]</Select>
        </Query>
        <Query Id="1" Path="System">
          <Select Path="System">*[System[(Level=1 or Level=2)]]</Select>
        </Query>
        <Query Id="2" Path="Application">
          <Select Path="Application">*[System[(Level=1 or Level=2)]]</Select>
        </Query>
      </QueryList>
    ]]>
  </Query>
  <ReadExistingEvents>false</ReadExistingEvents>
  <TransportName>{{ transport_name }}</TransportName>
  <ContentFormat>{{ content_format }}</ContentFormat>
  <Locale Language="en-US"/>
  <LogFile>ForwardedEvents</LogFile>
  <PublisherName>Microsoft-Windows-EventCollector</PublisherName>
  <AllowedSourceNonDomainComputers></AllowedSourceNonDomainComputers>
  <AllowedSourceDomainComputers>O:NSG:NSD:(A;;GA;;;DC)(A;;GA;;;NS)</AllowedSourceDomainComputers>
</Subscription>
