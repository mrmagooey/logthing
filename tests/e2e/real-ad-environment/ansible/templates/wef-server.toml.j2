# WEF Server Configuration
# Generated by Ansible for Real AD Testing Environment

bind_address = "{{ wef_bind_address }}"

[logging]
level = "{{ wef_log_level | default('info') }}"
format = "{{ wef_log_format | default('json') }}"

[metrics]
enabled = true
port = {{ wef_metrics_port | default(9090) }}

[syslog]
enabled = true
udp_port = 514
tcp_port = 601
parse_dns = true

[security]
# IP whitelisting - allow domain hosts
allowed_ips = {{ allowed_networks | to_json }}
max_connections = 10000

{% if wef_kerberos_enabled %}
# Kerberos/SPNEGO authentication
[security.kerberos]
enabled = true
spn = "{{ wef_kerberos_spn }}"
keytab = "{{ wef_keytab_path }}"
{% endif %}

[forwarding]
buffer_size = 1000
retry_attempts = 3

# Forward to S3/MinIO
[[forwarding.destinations]]
name = "parquet-s3"
url = "s3://{{ s3_bucket }}"
protocol = "http"
enabled = true

[forwarding.destinations.headers]
endpoint = "{{ s3_endpoint }}"
region = "us-east-1"
access-key = "{{ s3_access_key }}"
secret-key = "{{ s3_secret_key }}"
max-size-mb = "100"
flush-interval-secs = "300"
buffer-path = "{{ wef_data_dir }}/buffer"

# Event parser configuration
[parser]
event_parsers_path = "{{ wef_config_dir }}/event_parsers"
